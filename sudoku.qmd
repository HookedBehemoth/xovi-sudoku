AFFECT /xofm/libs/toolbar/impl/Toolbar.qml
    IMPORT common 1.0
    IMPORT net.sudoku 1.0
    TRAVERSE FocusScope > Item#toolbar > GridLayout
        LOCATE AFTER Repeater[.model=`toolbarProvider.editingTools`]
        INSERT {

ToolbarTool {
    id: puzzleOptions
    toolbar: root
    sticky: true
    type: ToolbarTool.Type.ToolbarButton

    iconSource: "qrc:/ark/icons/grid"
    enabled: true
    visible: root.expanded
    onPressed: root._select(puzzleOptions)

    function drawPuzzle(difficulty) {
        const puzzle = PuzzleManager.getSudoku(difficulty);
        if (puzzle === undefined ) {
            return;
        }

        for (var idx = 0; idx < 81; ++idx) {
            var numLine = PuzzleManager.getNumber(puzzle, idx % 9, idx / 9);
            if (numLine === undefined) {
                continue;
            }

            // draw hint
            sceneController.addDrawingLine(numLine);
            sceneView.tileManager.renderLineToTiles(numLine);
        }

        // draw surrouding grid
        const sudokuGrid = PuzzleManager.createGrid();
        sceneController.addDrawingLine(sudokuGrid);
        sceneView.tileManager.renderLineToTiles(sudokuGrid);

        sceneView.tileManager.reload();
    }

    foldoutContent: ColumnLayout {
        spacing: 0

        ListModel {
            id: difficulties
            ListElement {
                difficulty: 0
                description: "Easy"
            }
            ListElement {
                difficulty: 1
                description: "Medium"
            }
            ListElement {
                difficulty: 2
                description: "Hard"
            }
            ListElement {
                difficulty: 3
                description: "Expert"
            }
        }

        Repeater {
            model: difficulties

            ArkControls.FoldoutItem {
                required property string description
                required property int difficulty

                label: description
                iconSource: "qrc:/ark/icons/grid"
                antialiasing: root.antialiasing
                focusPolicy: Qt.NoFocus
                Layout.fillWidth: true
                onClicked: puzzleOptions.drawPuzzle(difficulty)
            }
        }
    }
}

        }
    END TRAVERSE
END AFFECT
